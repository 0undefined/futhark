// Partially pre-fused version of iswim4.l0.  We cannot fuse this at
// all.
fun [real] main([real] r, [[real]] a) =
  let divs = [0.00026609544843735446, 0.00008445945945945946,
                0.0008333333333333334] in
  let {b} =
    scanT(fn {[real]} ([real] x, [real] y) =>
            let {b1} =
              mapT(fn {real} (real p,
                              real v) =>
                     let res = p * v in
                     {res},
                   x, y) in
            {b1},
          {r}, a) in
  let {c} =
    mapT(fn {real} ([real] xs) =>
           let {b2} =
             mapT(fn {real} (real p, real v) =>
                    let res = p * v in
                    {res},
                  xs, divs) in
           let {b3} =
             reduceT(fn {real} (real x, real y) =>
                       let bop = x < y in
                       let v = if bop
                               then x
                               else y in
                       {v},
                     {b2[0]}, b2) in
           {b3},
         b) in
  c
